# Progress Log

## Learnings
(Patterns discovered during implementation)
- CustomTkinter uses `ctk.set_appearance_mode("Dark")` before creating app instance
- Window config goes in `__init__`: title(), geometry(), minsize()
- Grid layout configured with `grid_rowconfigure` and `grid_columnconfigure`
- Database singleton uses `_instance` class variable with `__new__` override
- platformdirs `user_data_dir()` returns platform-specific data directory
- SQLite WAL mode: `PRAGMA journal_mode=WAL`
- Use `sqlite3.Row` row_factory for dict-like access to columns
- Use `grid_propagate(False)` to keep frame fixed size
- Fixed column: `grid_columnconfigure(col, weight=0, minsize=N)`, expanding: `weight=1`
- fg_color tuple provides light/dark theme variants: `("lightColor", "darkColor")`
- Use standard `tk.Canvas` for pixel art drawing inside CTkFrame
- CTkProgressBar uses `set(value)` with 0.0-1.0 range
- Pet state schema: name, level, current_xp, evolution_stage
- CTkScrollableFrame provides scrollable container for dynamic content
- CTkFont supports `overstrike=True` for strikethrough text effect
- Task widgets stored in dict keyed by ID for efficient updates/removal

---

## Iteration 1 - US-001: Project scaffolding and app window
- What was implemented: Basic CustomTkinter app structure with 900x700 window, dark theme, title, and minimum size constraints
- Files changed: main.py (already existed with correct implementation), requirements.txt (dependencies: customtkinter, pillow, platformdirs)
- Learnings for future iterations:
  - The initial code was already well-structured following CustomTkinter best practices
  - Use `ctk.set_appearance_mode()` and `ctk.set_default_color_theme()` before creating the app instance
  - Grid layout with weight=1 makes content expand to fill window
---

## Iteration 2 - US-002: SQLite database and schema
- What was implemented: Database module with singleton pattern, SQLite storage in user data directory
- Files changed: database.py (new), main.py (added db initialization)
- Learnings for future iterations:
  - Database singleton ensures single connection across app
  - Tables created: tasks (with parent_id for subtasks), user_profile, pet_state
  - Default records auto-created for user_profile and pet_state
  - WAL mode enabled for better concurrent access
  - Foreign keys enabled with ON DELETE CASCADE for subtasks
---

## Iteration 3 - US-003: Main layout with sidebar and content area
- What was implemented: Two-column layout with fixed 200px sidebar and responsive content area
- Files changed: main.py (replaced placeholder with sidebar and content area)
- Learnings for future iterations:
  - Use `grid_propagate(False)` on frames to prevent them from shrinking to fit content
  - For fixed-width columns: `grid_columnconfigure(col, weight=0, minsize=N)`
  - For expanding columns: `grid_columnconfigure(col, weight=1)`
  - Different fg_color tuples for light/dark mode: `("gray90", "gray17")`
  - Visual separation achieved with different background colors
  - Placeholders left for pet area (US-004) and task list (US-005)
---

## Iteration 4 - US-004: Pet display with placeholder sprite
- What was implemented: Canvas-based pet sprite display with pixel art for all evolution stages, pet name label, level display, and XP progress bar
- Files changed: main.py (added pet sprite drawing, stats display, and helper methods)
- Learnings for future iterations:
  - Use standard `tk.Canvas` widget for drawing pixel art (embedded in CTkFrame)
  - `canvas.create_rectangle(x1, y1, x2, y2, fill=color, outline="")` draws filled pixels
  - Pet state loaded from database via `_load_pet_state()` method
  - XP formula: `int(50 * (level ** 1.5))` for polynomial curve
  - `CTkProgressBar.set(value)` sets progress bar value (0.0 to 1.0)
  - Color manipulation helpers (`_darken_color`, `_lighten_color`) use hex parsing
  - `update_pet_display()` method refreshes all pet-related UI elements
  - Evolution sprites defined as list of (x, y, color_type) tuples for pixel positions
---

## Iteration 5 - US-005: Task list display
- What was implemented: Scrollable task list with visual task items, completion status indicators, and empty state handling
- Files changed: main.py (added `_load_tasks()`, `_refresh_task_list()`, `_create_task_item()` methods; replaced task container with CTkScrollableFrame)
- Learnings for future iterations:
  - Use `CTkScrollableFrame` for scrollable content areas
  - Task items stored in `self.task_widgets` dict keyed by task ID for easy updates
  - Completed tasks use strikethrough font: `ctk.CTkFont(size=14, overstrike=True)`
  - Completion status shown with ✓ (green) or ○ (gray) symbols
  - Completed tasks visually dimmed with different text/background colors
  - `grid_forget()` hides widgets, `grid()` shows them (for empty state toggle)
  - Tasks loaded from DB ordered by completed ASC, created_at DESC (incomplete first, newest at top)
---
